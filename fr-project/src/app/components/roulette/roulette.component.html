<div class="tab-card">
  <h2>Roulette Game ğŸ°</h2>

  <div class="roulette-container">
    <div class="wheel-section">
      <div class="roulette-wheel">
        <div class="wheel-background" [style.transform]="'rotate(' + state.wheelRotation + 'deg)'"></div>
        <div class="wheel-inner" [style.transform]="'rotate(' + state.wheelRotation + 'deg)'">
          <div *ngFor="let i of getNumbers()"
               class="wheel-number"
               [ngClass]="{ 'selected': state.selectedNumber === i }"
               (click)="!state.isSpinning && selectNumber(i)"
               [style.transform]="'rotate(' + ((i * (360 / slots)) + (360 / (2 * slots))) + 'deg) translateY(-175px) rotate(-' + ((i * (360 / slots)) + (360 / (2 * slots))) + 'deg)'">
            {{ i }}
          </div>
        </div>
        <div class="wheel-pointer"></div>
      </div>

      <p class="selected-number" *ngIf="state.selectedNumber !== null">
        âœ“ Selected: <strong>{{ state.selectedNumber }}</strong>
      </p>
      <p class="select-hint" *ngIf="state.selectedNumber === null">
        ğŸ‘† Click a number to select
      </p>

      <div class="result-display" *ngIf="state.result !== null">
        <h4>Last Result</h4>
        <div class="result-number">{{ state.result }}</div>
        <div class="result-match" [ngClass]="{ 'win': state.selectedNumber === state.result, 'lose': state.selectedNumber !== state.result }">
          {{ state.selectedNumber === state.result ? 'âœ“ MATCH!' : 'âœ— No Match' }}
        </div>
        <button class="btn btn-tertiary" (click)="toggleSteps()" [disabled]="rouletteSteps.length === 0" style="margin-top: 12px;">
          {{ showSteps ? 'ğŸ‘ï¸ Hide Steps' : 'ğŸ‘ï¸ Show Steps' }}
        </button>
      </div>

      <div class="message" [ngClass]="'message-' + messageType" [class.shake-animation]="isShaking" *ngIf="message">
        {{ message }}
      </div>

      <div *ngIf="showSteps && rouletteSteps.length > 0" class="steps-container">
        <h4>BBS Steps</h4>
        <div class="steps-table">
          <div class="steps-header">
            <div class="step-col">Step (n)</div>
            <div class="step-col">X(n)</div>
            <div class="step-col">Bit</div>
          </div>
          <div *ngFor="let step of rouletteSteps" class="steps-row">
            <div class="step-col">{{ step.n }}</div>
            <div class="step-col">{{ step.xn }}</div>
            <div class="step-col">{{ step.bit }}</div>
          </div>
        </div>
      </div>
    </div>

    <div class="controls-section">
      <div class="control-group">
        <h3>Game Controls</h3>
        <div class="input-group">
          <label>Balance</label>
          <div class="balance-display">ğŸ’° ${{ state.balance }}</div>
        </div>
        <div class="input-group">
          <label for="bet-input">Bet Amount</label>
          <input type="number" id="bet-input" [(ngModel)]="state.bet" min="1" [max]="state.balance" [disabled]="state.isSpinning" />
        </div>
        <div class="input-group">
          <label>Selected Number</label>
          <div class="selected-display" [ngClass]="{ 'has-selection': state.selectedNumber !== null }">
            {{ state.selectedNumber !== null ? state.selectedNumber : 'None' }}
          </div>
        </div>
        <button class="btn btn-primary spin-button" (click)="spinRoulette()" [disabled]="state.isSpinning || state.balance <= 0 || state.selectedNumber === null">
          {{ state.isSpinning ? 'ğŸ”„ Spinning...' : 'ğŸ¯ SPIN!' }}
        </button>
        <button class="btn btn-secondary reset-button" (click)="resetGame()" [disabled]="state.isSpinning">ğŸ’« Reset Game</button>
      </div>

      <div class="control-group">
        <h3>Blum Blum Shub Parameters</h3>
        <div class="input-group">
          <label for="p-input">P (Prime)</label>
          <input type="number" id="p-input" [(ngModel)]="p" [disabled]="state.isSpinning" />
        </div>
        <div class="input-group">
          <label for="q-input">Q (Prime)</label>
          <input type="number" id="q-input" [(ngModel)]="q" [disabled]="state.isSpinning" />
        </div>
        <div class="input-group">
          <label for="seed-input">Seed</label>
          <input type="number" id="seed-input" [(ngModel)]="seed" [disabled]="state.isSpinning" />
        </div>
        <button class="btn btn-secondary" (click)="changeSeed()" [disabled]="state.isSpinning">ğŸ”€ Random Seed</button>
      </div>
    </div>
  </div>

  <div class="rules-section">
    <h3>Game Rules</h3>
    <ul>
      <li>Click on a number (0-19) to select your bet</li>
      <li>Set your bet amount (you win 36x your bet if correct)</li>
    </ul>
  </div>
</div>
