<div class="tab-card">
  <h2>Poker Card Shuffle ğŸ‚¡</h2>

  <div class="shuffle-container">
    <div class="params-section">
      <h3>Shuffle Parameters</h3>

      <div class="input-group">
        <label for="p-input">P (Prime)</label>
        <input type="number" id="p-input" [(ngModel)]="p" [disabled]="isShuffling" placeholder="e.g., 61" />
      </div>

      <div class="input-group">
        <label for="q-input">Q (Prime)</label>
        <input type="number" id="q-input" [(ngModel)]="q" [disabled]="isShuffling" placeholder="e.g., 53" />
      </div>

      <div class="input-group">
        <label for="seed-input">Seed</label>
        <input type="number" id="seed-input" [(ngModel)]="seed" [disabled]="isShuffling" placeholder="e.g., 12" />
      </div>

      <div class="button-group">
        <button class="btn btn-primary" (click)="shuffleDeck()" [disabled]="isShuffling">
          {{ isShuffling ? 'ğŸ”„ Shuffling...' : 'ğŸ”€ Shuffle Deck' }}
        </button>
        <button class="btn btn-secondary" (click)="changeSeed()" [disabled]="isShuffling">
          ğŸ² Random Seed
        </button>
        <button class="btn btn-secondary" (click)="resetDeck()" [disabled]="isShuffling">
          â†º Reset Deck
        </button>
      </div>

      <div *ngIf="message" class="message" [ngClass]="'message-' + messageType" [class.shake-animation]="isShaking">
        {{ message }}
      </div>
    </div>

    <div class="deck-section">
      <div class="original-deck">
        <h4>Original Deck (52 cards)</h4>
        <div class="cards-display">
          <div *ngFor="let card of deck" class="card">
            <span class="card-symbol" [ngClass]="'suit-' + (card.suit === 'â™¥' || card.suit === 'â™¦' ? 'red' : 'black')">
              {{ card.symbol }}
            </span>
          </div>
        </div>
      </div>

      <div *ngIf="showShuffledDeck" class="shuffled-deck">
        <h4>Shuffled Deck ({{ shuffledDeck.length }} cards remaining)</h4>
        <div class="cards-display">
          <div *ngFor="let card of shuffledDeck" class="card">
            <span class="card-symbol" [ngClass]="'suit-' + (card.suit === 'â™¥' || card.suit === 'â™¦' ? 'red' : 'black')">
              {{ card.symbol }}
            </span>
          </div>
        </div>

        <div class="draw-buttons">
          <button class="btn btn-tertiary" (click)="drawCards(1)">Draw 1 Card</button>
          <button class="btn btn-tertiary" (click)="drawCards(5)">Draw 5 Cards (Hand)</button>
          <button class="btn btn-tertiary" (click)="toggleHands()" [disabled]="drawnHands.length === 0">
            {{ showHands ? 'ğŸ‘ï¸ Hide Hands' : 'ğŸ‘ï¸ Show Hands' }}
          </button>

          <button class="btn btn-secondary" (click)="toggleSteps()" [disabled]="shuffleSteps.length === 0">
            {{ showSteps ? 'ğŸ‘ï¸ Hide Steps' : 'ğŸ“‹ Show Steps' }}
          </button>

          <button class="btn btn-tertiary" (click)="resetDeck()">New Shuffle</button>
        </div>

        <div *ngIf="showSteps && shuffleSteps.length > 0" class="steps-container">
          <h4>BBS Steps</h4>
          <div class="steps-table">
            <div class="steps-header">
              <div class="step-col">Swap #</div>
              <div class="step-col">BBS State (Xn)</div>
              <div class="step-col">Swap Index</div>
            </div>
            <div *ngFor="let step of shuffleSteps" class="steps-row">
              <div class="step-col">{{ step.n }}</div>
              <div class="step-col text-truncate">{{ step.xn }}</div>
              <div class="step-col">{{ step.bit }}</div>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>

  <div *ngIf="showHands" class="hands-modal-overlay" (click)="toggleHands()">
    <div class="hands-modal" (click)="$event.stopPropagation()">
      <div class="hands-header">
        <h3>Your Hands ({{ drawnHands.length }} hand{{ drawnHands.length !== 1 ? 's' : '' }})</h3>
        <button class="close-btn" (click)="toggleHands()">âœ•</button>
      </div>
      <div class="hands-content">
        <div class="hands-display">
          <div *ngFor="let hand of drawnHands; let i = index" class="single-hand">
            <div class="hand-label">Hand {{ i + 1 }} ({{ hand.length }} cards)</div>
            <div class="hands-cards">
              <div *ngFor="let card of hand" class="hand-card">
                <div class="hand-card-face">
                  <span class="hand-card-symbol" [ngClass]="'suit-' + (card.suit === 'â™¥' || card.suit === 'â™¦' ? 'red' : 'black')">
                    {{ card.symbol }}
                  </span>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
      <div class="hands-footer">
        <button class="btn btn-secondary" (click)="clearHands()">Clear Hand</button>
        <button class="btn btn-primary" (click)="toggleHands()">Close</button>
      </div>
    </div>
  </div>

  <div class="info-section">
    <h3>How It Works</h3>
    <ul>
      <li>ğŸ” Uses Blum Blum Shub generator for cryptographically secure shuffling</li>
      <li>ğŸ´ Implements Fisher-Yates shuffle algorithm</li>
      <li>ğŸ“‹ Each swap is derived directly from the BBS mathematical sequence</li>
    </ul>
  </div>
</div>
